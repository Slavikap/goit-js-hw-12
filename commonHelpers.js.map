{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js"],"sourcesContent":["export default function renderCard(cards) {\n    const gallery = document.querySelector('.cards');\n          cards.forEach(card => {\n            const cardHTML =\n                `<li class=\"card\"> \n                    <a class=\"card-link\" href=\"${card.largeImageURL}\">\n                        <img class=\"card-img\" src=\"${card.webformatURL}\" alt=\"${card.tags}\" data-source=\"${card.largeImageURL}\" />\n                    </a>\n                    <div class=\"card-data\">\n                        <div class=\"data-wrap\">\n                            <p>Likes: </p>\n                            <span>${card.likes}</span>\n                        </div>\n                        <div class=\"data-wrap\">\n                            <p>Views: </p>\n                            <span>${card.views}</span>\n                        </div>\n                        <div class=\"data-wrap\">\n                            <p>Comments: </p>\n                            <span>${card.comments}</span>\n                        </div>\n                        <div class=\"data-wrap\">\n                            <p>Downloads: </p>\n                            <span>${card.downloads}</span>\n                        </div>\n                    </div>\n                 </li>`;\n              gallery.innerHTML += cardHTML;\n              \n        })\n    }","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\nimport renderCard from './render-functions.js';\n\nconst form = document.querySelector('.form');\nconst loader = document.querySelector('.loader');\nconst loadmoreBtn = document.querySelector('.load-more-btn');\nconst newCard = document.querySelector('.card');\nconst bottomLoader = document.querySelector('.bottom-loader')\nlet lastScrollPosition = window.pageYOffset;\n\nlet page = 1;\nlet perPage = 15;\nlet userInput = '';\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    userInput = event.target.elements.search.value.trim();\n    page = 1;\n\n\n    \n    if (userInput === \"\") {\n        iziToast.show({\n            title: 'Error',\n            backgroundColor: '#EF4040',\n            messageColor: '#FFFFFF',\n            titleColor: '#FFFFFF',\n            message: 'Please enter a search query!',\n            position: 'bottomRight'\n        });\n        return;\n    }\n\n    showLoader();\n\n    const options = {\n        key: '42328453-99f2c5c34c77a0496905bbef3',\n        q: userInput,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n    }\n\n    const PARAMS = new URLSearchParams(options);\n\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?${PARAMS}`)\n        const data = response.data;\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n            \n        if (data.hits.length === 0) {\n            const gallery = document.querySelector('.cards');\n            gallery.innerHTML = '';  \n            hideLoader();\n            hideLoadBtn();\n            iziToast.show({\n                title: 'Error',\n                backgroundColor: '#EF4040',\n                messageColor: '#FFFFFF',\n                titleColor: '#FFFFFF',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'bottomRight'\n            })\n        } else {\n            const gallery = document.querySelector('.cards');\n            gallery.innerHTML = '';\n            renderCard(data.hits);\n            const lightbox = new SimpleLightbox(\".cards a\", { captionsData: \"alt\", captionDelay: 250, captionPosition: 'bottom' });\n            lightbox.refresh();\n            hideLoader();\n            showLoadBtn();\n            form.reset();\n\n            if (perPage > data.hits.length && response.status === 200) {\n                hideLoadBtn();\n                form.reset();\n                return iziToast.error({\n                position: \"bottomRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                })\n            }\n        }\n        \n        page += 1;\n\n        \n        \n    } catch (error) {\n        console.log(error);\n        hideLoadBtn();\n        hideChangeLoader();\n        hideLoader();\n        form.reset();\n        return iziToast.error({\n        position: \"bottomRight\",\n            message: \"Sorry, something went wrong...\"\n        })\n    }\n    \n})\n\nloadmoreBtn.addEventListener('click', async (event) => {\n    showChangeLoader();\n    hideLoadBtn();\n    \n    const options = {\n        key: '42328453-99f2c5c34c77a0496905bbef3',\n        q: userInput,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n    }\n\n    const PARAMS = new URLSearchParams(options);\n\n    try {\n        if (page > 1) {\n            const response = await axios.get(`https://pixabay.com/api/?${PARAMS}`)\n            const data = response.data;\n            const totalPages = Math.ceil(data.totalHits / perPage);\n            if (page > totalPages) {\n                hideLoadBtn();\n                hideLoader();\n                hideChangeLoader();\n                return iziToast.error({\n                position: \"bottomRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                })\n            } else {\n                renderCard(data.hits);\n                const lightbox = new SimpleLightbox(\".cards a\", { captionsData: \"alt\", captionDelay: 250, captionPosition: 'bottom' });\n                lightbox.refresh();\n                showLoadBtn();\n                hideChangeLoader();\n                hideLoader();\n                scroll();\n                page += 1;\n\n                if (perPage > data.hits.length && response.status === 200) {\n                hideLoadBtn();\n                form.reset();\n                return iziToast.error({\n                position: \"bottomRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                })\n                }\n            }\n\n        }\n\n    } catch (error) {\n        console.log(error);\n        hideLoadBtn();\n        hideChangeLoader();\n        hideLoader();\n        form.reset();\n        return iziToast.error({\n        position: \"bottomRight\",\n            message: \"Sorry, something went wrong...\"\n        })\n    }\n})\n\nfunction showLoader() {\n    loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n    loader.style.display = 'none';\n}\n\nfunction showLoadBtn() {\n    loadmoreBtn.style.display = 'flex';   \n}\n\nfunction hideLoadBtn() {\n    loadmoreBtn.style.display = 'none';   \n}\n\nfunction showChangeLoader() {\n    bottomLoader.style.display = 'flex';\n}\n\nfunction hideChangeLoader() {\n    bottomLoader.style.display = 'none';\n}\n\nfunction scroll() {\n    const gallery = document.querySelector('.cards');\n    const cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n}\n"],"names":["renderCard","cards","gallery","card","cardHTML","form","loader","loadmoreBtn","bottomLoader","page","perPage","userInput","event","iziToast","showLoader","options","PARAMS","response","axios","data","hideLoader","hideLoadBtn","SimpleLightbox","showLoadBtn","error","hideChangeLoader","showChangeLoader","totalPages","scroll","cardHeight"],"mappings":"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"}